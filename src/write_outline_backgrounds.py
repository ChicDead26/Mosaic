import os
import xml.etree.ElementTree as xml

root_path = "Projects/Outline/Export/Rooms"
bg_screen = """
        032F 0346 032D 0346 032E 0346 032D 0346 032E 0346 032D 0346 032E 0346 032D 0346
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        0327 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        032B 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        0327 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        032B 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        0327 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        032B 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343 032A 0343 0329 0343
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
        0327 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340 0326 0340 0325 0340
        0342 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325 0341 0325 0340 0325
"""    

for room_filename in os.listdir(root_path):
    room_path = os.path.join(root_path, room_filename)
    print(room_path)
    tree = xml.parse(room_path)
    # TODO: check GFXset == 0x20 to avoid overwriting BGs that we shouldn't.
    # Also Dust Torizo Room needs to be handled specially.
    states = tree.findall("./States/State")
    for state_node in states:
        layer2_screens = state_node.findall("./LevelData/Layer2/Screen")
        for screen in layer2_screens:
            screen.text = bg_screen
    tree.write(room_path)
